# Parasprite

This is a 200-point reversing challenge, courtesy of Pacific Northwest National Laboratories. This time we want to cite them in the problem description because there's a PDB referenced in the executable with a path containing "FY15" in it. So I want to be clear that we're not all secretly feds or something.

The good news about this challenge is that it is a 32-bit Windows executable. So, the players get to test their Windows reversing skills. I'm making it 200 points because Pink Elephant Unicorn made it 200 points, and because it will probably make a lot of students fire up Ollydbg.

The bad news is that I just found out that "Parasprite" is a "My Little Pony" reference so I feel somewhat emasculated submitting this challenge. >_<

This binary takes an argument and checks it. If it's the correct argument, the binary takes two base64-encoded strings in its memory, concatenates them, and prints: "The flag is: \"Ugh. Now I gotta go find a tr0mb0n3 >.<\"" Otherwise, it prints, "Nice try, n00bcake" and exits. 

Running `strings` on the binary in Linux does not reveal any of these strings, nor does it reveal the base64-encoded strings. Running `strings` on the binary in Windows will provide some information. To solve this I first took a look at the binary in IDA Pro. I got a sense that there was a check run on an input parameter before "Nice try, n00bcake" was printed, but I couldn't debug the program since I was running IDA Pro in Linux. I booted up my Flare VM and took a look at the program in Ollydbg. I found the strings in the binary by viewing the hexadecimal but they're either obfuscated or some feature of Windows placed a null byte after each letter in the strings, which may be why I couldn't find the strings in Linux. Anyway, I thought about figuring out breakpoints in OllyDBG and then stepping in to see what parameter the user should pass in to avoid the "Nice try, n00bcake" fail. So I started looking up how to find strings in OllyDBB, wasn't finding the message that gets printed due to those null bytes, and that's when I took another look at running `strings` from the Windows command prompt and noticed two other bas64-encoded strings in the output as well as some "base64decode" function names. I put two and two together, concatenated these two strings and base64-decoded them, and got the flag. Felt kind of amateur hour for me, but that's because I haven't spent time reverse engineering Windows binaries. This would probably be easy for some students who are running Windows natively, and for others it will be a pain because they will do what I did, with setting up a Windows VM for reversing Windows binaries. I personally think this is worth doing. 

The next piece is that the flag isn't in the standard flag{} format. I'm going to make the flag be "flag{Ugh. Now I gotta go find a tr0mb0n3 >.<}". Then I'll make a note about the format in the problem description, with an example conversion. I think that's pretty clear. If anyone pings the Mailbot we can help them. If they ping us five minutes after the competition and claim that the flag was in the wrong format and wasn't accepted, too bad for them.
